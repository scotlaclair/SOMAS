Template Data Inventory & MappingPurpose: This document audits all template files in the repository and serves as the Human-Readable Specification for the Agent YAML configurations. It translates the raw YAML logic into readable Prompt Contracts.1. Issue Templates (Inputs for Stage 01 - INTAKE)Location: .github/ISSUE_TEMPLATE/|| Template File | Intended Use Case | Key Fields (YAML ID) | Data Type | Consuming Agent | Mapping Logic || somas-change.yml | Standard Feature/Change | description | Text | triage | Main input for feasibility analysis. ||  |  | goals | List | advisor | Used for Strategic Alignment check. ||  |  | priority | Dropdown | triage | Sets initial priority:* label. || somas-bug.yml | Bug Reports | steps_to_reproduce | Text | tester | Used to generate reproduction test cases in Stage 06. ||  |  | expected_behavior | Text | verifier | Benchmark for "Success". ||  |  | environment | Dropdown | implementer | Sets context (Prod vs Staging). || somas-enhance.yml | Optimizations | current_bottleneck | Text | analyzer | Baseline metric for optimization. ||  |  | success_metric | Text | specifier | Becomes the "Exit Gate" criteria. |2. Document Templates (Inputs for Stages 02-04)Location: .somas/templates/| Template File | Stage | Lifecycle Role | Key Sections (Headers) | Consuming Agent | Usage || SPEC.md | 02 | Product Req. Doc | ## Goals | architect | Design constraints. ||  |  |  | ## User Stories | requirements | Validation checklist source. ||  |  |  | ## Acceptance Criteria | tester | Test case generation source. || architecture.md | 03 | System Design | ## Component Diagram | planner | Node identification for DAG. ||  |  |  | ## Data Flow | security | Threat modeling input. || plan.md | 03 | Execution Plan | ## Phases | decomposer | High-level grouping. ||  |  |  | ## Dependencies | planner | DAG edge creation. || execution_plan.yml | 04 | Task Graph | tasks: | implementer | The strict list of work items. ||  |  |  |   - id: | orchestrator | State tracking ID. ||  |  |  |     depends_on: | orchestrator | Sequencing logic. |3. Operational Templates & JSON Schemas (Validation & State)Location: .somas/templates/| Template File | Stage | Lifecycle Role | Key JSON Keys | Consuming Agent | Usage || dead_letters_template.json | All | Error Handling | error_code | debugger | Determines "Self-Heal" strategy. ||  |  |  | stack_trace | debugger | Context for fix generation. || dead_letters_schema.json | All | Error Validation | required | runner | Validates error log format before storage. || state_template.json | All | State Persistence | current_stage | orchestrator | Resume capability. ||  |  |  | artifacts | all | File path passing between agents. || state_schema.json | All | State Validation | properties | state_manager | Enforces type safety on state transitions. || transitions_schema.json | All | Logic Flow | valid_transitions | orchestrator | Prevents illegal stage jumps (e.g. 01 -> 09). || meta-capture.md | 11 | Post-Mortem | ## Timeline | analyzer | SLA calculation. ||  |  |  | ## Cost | manager | Budget auditing. |4. APO & Cognitive Templates (Reasoning Logic)Location: .somas/apo/These files define the "Thinking Strategy" used by higher-order agents.| Template File | Intended Use Case | Key Fields | Consuming Agent | Mapping Logic || mental-models.yml | Decision Frameworks | models (e.g. "First Principles") | advisor, architect | Injects reasoning strategies into the System Prompt. || task-analyzer.yml | Complexity Scoring | complexity_factors | triage, planner | Input for cost estimation and timeout calculations. || chains/collision.yml | Conflict Resolution | resolution_strategies | merger, triage | Logic for resolving opposing requirements. || chains/strategic-diamond.yml | Strategy Formulation | arenas, vehicles | advisor | Checks if a Feature Request matches the Core Strategy. || base-prompt.yml | Agent Persona Base | role_definitions | all | The base "You are an X" instruction set. |5. Agent Logic Specifications (Human Readable View of YAMLs)This section details the logic defined in the .somas/agents/*.yml files.Stage 01: INTAKEPrompt ID: prompts/triage/classify.mdParent Config: .somas/agents/triage.ymlBase Persona: somas/apo/base-prompt.yml (Role: Product Manager)Mental Model: task-analyzer.yml (Complexity Scoring)Goal: Classify the incoming issue to determine feasibility and routing.Input Variables: {{issue_title}}, {{issue_body}}Instructions:Analyze the intent: Is it a Bug, Feature, or Question?Assess Feasibility (0-1): Do we have enough info to start?Example Output:## Classification
- **Type**: Feature
- **Feasibility**: 0.9
- **Route**: Stage 02 (Specify)

Prompt ID: prompts/advisor/alignment.mdParent Config: .somas/agents/advisor.ymlMental Model: chains/strategic-diamond.ymlGoal: Ensure the request aligns with project goals (prevent scope creep).Input Variables: {{issue_body}}, {{project_goals}}Instructions:Compare request against project_goals.Check for strategic collisions.Example Output:{ "alignment_score": 0.9, "risk_flags": [], "priority_label": "priority:high" }

Stage 02: SPECIFYPrompt ID: prompts/specifier/generate_prd.mdParent Config: .somas/agents/specifier.ymlMental Model: mental-models.yml (First Principles)Goal: Convert informal issue text into a formal SPEC.md.Input Variables: {{issue_body}}, {{template}}Instructions:Fill every section of the template.Infer "User Stories" if not explicitly stated.Example Output: Full Markdown content for docs/specs/ISSUE-123.md.Prompt ID: prompts/requirements/verify.mdParent Config: .somas/agents/requirements.ymlGoal: Validate the generated PRD for completeness.Input Variables: {{spec_content}}Instructions:Find "vague" words (e.g., "fast", "scalable") and demand metrics.Ensure all Acceptance Criteria are testable.Example Output: Checklist with pass/fail status.Stage 03: PLANPrompt ID: prompts/architect/system_design.mdParent Config: .somas/agents/architect.ymlMental Model: mental-models.yml (Systems Thinking)Goal: Design the file structure and data flow.Input Variables: {{spec_content}}, {{current_file_tree}}Instructions:Identify files to create/modify.Select Design Patterns.Example Output: Architecture Document (docs/arch/ISSUE-123.md).Prompt ID: prompts/simulator/monte_carlo.mdParent Config: .somas/agents/simulator.ymlGoal: Predict failure probability.Input Variables: {{design_doc}}Instructions:Simulate 1000 execution runs.Identify "Fragile" components.Example Output: {"success_prob": 0.82, "risks": ["api_timeout"]}.Prompt ID: prompts/planner/create_dag.mdParent Config: .somas/agents/planner.ymlMental Model: task-analyzer.ymlGoal: Create a Directed Acyclic Graph (DAG) of execution tasks.Input Variables: {{design_doc}}, {{risk_analysis}}Instructions:Break work into dependencies (depends_on).Ensure no cycles exist.Example Output: JSON structure for execution_plan.yml.Stage 04: DECOMPOSEPrompt ID: prompts/decomposer/breakdown.mdParent Config: .somas/agents/decomposer.ymlGoal: Convert high-level Plan Nodes into atomic Coding Tasks.Input Variables: {{plan_json}}Instructions:Task must be specific: "Write function X in file Y".Include "Verification Step" for every task.Example Output: GitHub Tasklist (- [ ] Task 1).Stage 05: IMPLEMENTPrompt ID: prompts/templates/single_shot_implementer.md (EXISTING)Parent Config: .somas/agents/implementer.ymlBase Persona: somas/apo/base-prompt.yml (Role: Senior Dev)Goal: Write production-ready code.Input Variables: {{task_description}}, {{related_files}}, {{style_guide}}Instructions:Return ONLY code.Follow PEP8/Black.Example Output: Valid Python/JS code block.Stage 06: VERIFYPrompt ID: prompts/tester/generate_tests.mdParent Config: .somas/agents/tester.ymlGoal: Write pytest cases.Input Variables: {{source_code}}, {{acceptance_criteria}}Instructions:Achieve >85% coverage.Include edge cases.Example Output: tests/test_feature.py.Prompt ID: prompts/debugger/analyze_traceback.mdParent Config: .somas/agents/debugger.ymlMental Model: dead_letters_template.json (Error Taxonomy)Goal: Fix code based on error logs.Input Variables: {{source_code}}, {{traceback}}Instructions:Analyze root cause.Apply minimal fix.Example Output: Git Diff or patched file.Stage 07: INTEGRATEPrompt ID: prompts/validator/traceability.mdParent Config: .somas/agents/validator.ymlGoal: Ensure every Requirement has a Test Case.Input Variables: {{spec_md}}, {{test_files}}Instructions:Map Req ID -> Test ID.Example Output: Traceability Matrix (Markdown Table).Stage 08: HARDENPrompt ID: prompts/security/triage_vulns.mdParent Config: .somas/agents/security.ymlGoal: Assess severity of findings.Input Variables: {{sarif_json}}Instructions:Prioritize High/Critical CVEs.Ignore False Positives.Example Output: Security Assessment Report.Stage 09: RELEASEPrompt ID: prompts/deployer/generate_release_notes.mdParent Config: .somas/agents/deployer.ymlGoal: Create user-friendly release notes.Input Variables: {{commit_log}}, {{pr_descriptions}}Instructions:Categorize: Features, Fixes.Suggest SemVer version.Example Output: CHANGELOG entry.Stage 10: OPERATEPrompt ID: prompts/operator/analyze_health.mdParent Config: .somas/agents/operator.ymlGoal: Interpret health check logs.Input Variables: {{http_response_log}}, {{metrics}}Instructions:Check for 200 OK.Flag latency spikes.Example Output: {"status": "healthy"}.Stage 11: ANALYZEPrompt ID: prompts/analyzer/post_mortem.mdParent Config: .somas/agents/analyzer.ymlMental Model: meta-capture.mdGoal: Analyze workflow performance.Input Variables: {{timeline_log}}, {{cost_log}}Instructions:Calculate Cycle Time.Identify bottlenecks.Example Output: Post-Mortem Analysis Report.6. Secrets & Environment Variables RegistryRequired secrets for the Workflows to function.| Secret Key | Scope | Usage | Required By (Agents) || OPENAI_API_KEY | Repo | LLM Inference | All Agents || GH_TOKEN / GITHUB_TOKEN | Repo | API Operations (Issues, PRs, Content) | Triage, Implementer, Merger || PYPI_API_TOKEN | Repo | Publishing Packages | Deployer || SLACK_WEBHOOK_URL | Repo | Notifications (Ops) | Operator, Triage || SONAR_TOKEN | Repo | SAST Scanning | Security |7. Unimplemented Specifications (Missing Files)The following logic blocks are defined in this document but are missing the corresponding physical file (Markdown or YAML entry).prompts/triage/classify.mdprompts/advisor/alignment.mdprompts/specifier/generate_prd.mdprompts/requirements/verify.mdprompts/architect/system_design.mdprompts/simulator/monte_carlo.mdprompts/planner/create_dag.mdprompts/decomposer/breakdown.mdprompts/tester/generate_tests.mdprompts/debugger/analyze_traceback.mdprompts/validator/traceability.mdprompts/security/triage_vulns.mdprompts/operator/analyze_health.md